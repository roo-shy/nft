{"version":3,"file":"react-svg.esm.js","sources":["../compiled/shallow-differs.js","../compiled/ReactSVG.js"],"sourcesContent":["// Hat-tip: https://github.com/developit/preact-compat/blob/master/src/index.js#L402.\nconst shallowDiffers = (a, b) => {\n    for (const i in a) {\n        if (!(i in b)) {\n            return true;\n        }\n    }\n    for (const i in b) {\n        if (a[i] !== b[i]) {\n            return true;\n        }\n    }\n    return false;\n};\nexport default shallowDiffers;\n","import { SVGInjector } from '@tanem/svg-injector';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\nimport shallowDiffers from './shallow-differs';\nconst svgNamespace = 'http://www.w3.org/2000/svg';\nconst xlinkNamespace = 'http://www.w3.org/1999/xlink';\nexport class ReactSVG extends React.Component {\n    constructor() {\n        super(...arguments);\n        this.initialState = {\n            hasError: false,\n            isLoading: true,\n        };\n        this.state = this.initialState;\n        this._isMounted = false;\n        this.refCallback = (container) => {\n            this.container = container;\n        };\n    }\n    renderSVG() {\n        /* istanbul ignore else */\n        if (this.container instanceof Node) {\n            const { beforeInjection, evalScripts, renumerateIRIElements, src, useRequestCache, } = this.props;\n            /* eslint-disable @typescript-eslint/no-non-null-assertion */\n            const afterInjection = this.props.afterInjection;\n            const wrapper = this.props.wrapper;\n            /* eslint-enable @typescript-eslint/no-non-null-assertion */\n            let nonReactElement;\n            if (wrapper === 'svg') {\n                nonReactElement = document.createElementNS(svgNamespace, wrapper);\n                nonReactElement.setAttribute('xmlns', svgNamespace);\n                nonReactElement.setAttribute('xmlns:xlink', xlinkNamespace);\n            }\n            else {\n                nonReactElement = document.createElement(wrapper);\n            }\n            nonReactElement.dataset.src = src;\n            this.nonReactElement = this.container.appendChild(nonReactElement);\n            const afterEach = (error, svg) => {\n                if (error) {\n                    this.removeSVG();\n                    if (!this._isMounted) {\n                        afterInjection(error);\n                        return;\n                    }\n                }\n                this.nonReactElement = svg;\n                // TODO (Tane): It'd be better to cleanly unsubscribe from SVGInjector\n                // callbacks instead of tracking a property like this.\n                if (this._isMounted) {\n                    this.setState(() => ({\n                        hasError: !!error,\n                        isLoading: false,\n                    }), () => {\n                        afterInjection(error, svg);\n                    });\n                }\n            };\n            SVGInjector(nonReactElement, {\n                afterEach,\n                beforeEach: beforeInjection,\n                cacheRequests: useRequestCache,\n                evalScripts,\n                renumerateIRIElements,\n            });\n        }\n    }\n    removeSVG() {\n        if (this.container instanceof Node &&\n            this.nonReactElement instanceof Node) {\n            this.container.removeChild(this.nonReactElement);\n            this.nonReactElement = null;\n        }\n    }\n    componentDidMount() {\n        this._isMounted = true;\n        this.renderSVG();\n    }\n    componentDidUpdate(prevProps) {\n        if (shallowDiffers(prevProps, this.props)) {\n            this.setState(() => this.initialState, () => {\n                this.removeSVG();\n                this.renderSVG();\n            });\n        }\n    }\n    componentWillUnmount() {\n        this._isMounted = false;\n        this.removeSVG();\n    }\n    render() {\n        /* eslint-disable @typescript-eslint/no-unused-vars */\n        const { afterInjection, beforeInjection, evalScripts, fallback: Fallback, loading: Loading, renumerateIRIElements, src, useRequestCache, wrapper, ...rest } = this.props;\n        /* eslint-enable @typescript-eslint/no-unused-vars */\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const Wrapper = wrapper;\n        return (React.createElement(Wrapper, Object.assign({}, rest, { ref: this.refCallback }, (wrapper === 'svg'\n            ? {\n                xmlns: svgNamespace,\n                xmlnsXlink: xlinkNamespace,\n            }\n            : {})),\n            this.state.isLoading && Loading && React.createElement(Loading, null),\n            this.state.hasError && Fallback && React.createElement(Fallback, null)));\n    }\n}\nReactSVG.defaultProps = {\n    afterInjection: () => undefined,\n    beforeInjection: () => undefined,\n    evalScripts: 'never',\n    fallback: null,\n    loading: null,\n    renumerateIRIElements: true,\n    useRequestCache: true,\n    wrapper: 'div',\n};\nReactSVG.propTypes = {\n    afterInjection: PropTypes.func,\n    beforeInjection: PropTypes.func,\n    evalScripts: PropTypes.oneOf(['always', 'once', 'never']),\n    fallback: PropTypes.oneOfType([\n        PropTypes.func,\n        PropTypes.object,\n        PropTypes.string,\n    ]),\n    loading: PropTypes.oneOfType([\n        PropTypes.func,\n        PropTypes.object,\n        PropTypes.string,\n    ]),\n    renumerateIRIElements: PropTypes.bool,\n    src: PropTypes.string.isRequired,\n    useRequestCache: PropTypes.bool,\n    wrapper: PropTypes.oneOf(['div', 'span', 'svg']),\n};\n"],"names":["shallowDiffers","a","b","i","svgNamespace","xlinkNamespace","ReactSVG","arguments","initialState","hasError","isLoading","state","_isMounted","refCallback","container","renderSVG","Node","props","beforeInjection","evalScripts","renumerateIRIElements","src","useRequestCache","afterInjection","wrapper","nonReactElement","document","createElementNS","setAttribute","createElement","dataset","appendChild","afterEach","error","svg","removeSVG","setState","SVGInjector","beforeEach","cacheRequests","removeChild","componentDidMount","componentDidUpdate","prevProps","componentWillUnmount","render","Fallback","fallback","Loading","loading","rest","Wrapper","React","Object","assign","ref","xmlns","xmlnsXlink","defaultProps","undefined","propTypes","PropTypes","isRequired"],"mappings":"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"}